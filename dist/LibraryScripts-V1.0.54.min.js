!function(){window.version="V1.0.54",console.log("Loading Custom Library Functionaltiy",location.pathname);let t=null,e=null;const n={observer:null,container:null},o={observer:null,container:null};function r(t,e,n){const o=document.querySelector(e);if(o){if(t.observer){if(t.container&&document.contains(t.container))return;t.observer.disconnect(),t.observer=null,t.container=null}t.observer=new MutationObserver(n),t.observer.observe(o,{childList:!0,subtree:!0}),t.container=o}}function a(t,e,n,o){const r=e?e.toLowerCase():null;document.querySelectorAll(t).forEach(t=>{const e=t.textContent.replace(/\s+/g," ").trim().toLowerCase();r&&!e.includes(r)||(t.innerHTML=n,"function"==typeof o&&t.addEventListener("click",o))})}function i(t,e){const n=Array.isArray(e)?e:[e];document.querySelectorAll(t).forEach(t=>{const e=t.textContent.replace(/\s+/g," ").trim().toLowerCase();n.some(t=>e.includes(t.toLowerCase()))&&(t.style.display="none")})}function c(){a("h3","Request","Place Library Order"),a("button.ant-btn-primary","submit quote","Submit order"),a(".ant-modal-body p","This option is for",""),a(".ant-modal-body p","Use the box below","Any special instructions or questions about your order?"),a(".ant-modal-body em","your cart will be","Your cart will be cleared upon submitting your order."),setTAValue("My order is good to go.")}function s(){a("button.ant-btn.ant-btn-default.ant-btn-block","Request a school","Place Library Order",()=>setTimeout(c,50)),i("button.ant-btn-default.checkout-btn","Ship"),i("button.ant-btn-primary.checkout-btn","Pick up"),i("button.ant-btn-default.ant-btn-block","Deliver")}function u(){a("span","requested a quote","<strong>Order Type</strong> Library"),a(".ant-card-body div:not(:has(*))","requested a quote","Standard library delivery")}function l(){const a=location.pathname.startsWith("/checkout/cart"),i=location.pathname.startsWith("/account/orders");if(!a&&!i)return void(t&&(clearInterval(t),t=null,e=null));const c=a?"cart":"order";if(t){if(e===c)return;clearInterval(t),t=null,e=null}a?r(n,"aside.responsiveSummary",s):i&&r(o,"aside.responsiveSummaryLeft",u);let l=0,d=!1;const b=a?20:40;e=c,t=setInterval(()=>{l++;try{(function(t){if(console.log("showAccountIdWhenRequested: Showing account ID for user:",t),!ShowAcctIds.length||!t)return;const e=ShowAcctIds.map(t=>t.toLowerCase()),n=document.querySelectorAll("button.ant-btn-primary.styled_btn span,.ant-avatar-string div,.ant-drawer-title");n.length&&n.forEach(n=>{const o=n.textContent.trim().toLowerCase();e.some(t=>o.includes(t))&&(n.textContent.includes("ID:")||(n.textContent=`${t.company||t.first_name} (ID: ${t.corp_id} VER: ${window.version})`))})})(libUser),a?s():i&&(u(),Array.from(document.querySelectorAll("span")).some(t=>{const e=t.textContent.toLowerCase();return e.includes("order type")&&e.includes("library")})&&(d=!0))}catch(t){console.error("CustLibFunc: watcher error in interval",t)}!d&&b>l||(clearInterval(t),t=null,e=null)},a?125:250)}function d(){console.log("CustLibFunc: runLibTweaksForCurrentPage on",location.pathname),location.pathname.startsWith("/checkout/cart")&&s(),location.pathname.startsWith("/account/orders")&&(console.log("CustLibFunc: Order Summary Watcher Running"),a(".ant-result-title span","your quote request has been submitted","<strong>Your order has been submitted.</strong><br/><br/>"),a(".ant-result-subtitle div","we will review your quote and comments","<b>IMPORTANT NOTE: Your email confirmation will label this order a &quot;Quote Request,&quot; but we will process it as an order from your library.</b>"))}!function(){const t=history.pushState,e=history.replaceState;function n(){d(),l()}history.pushState=function(){const e=t.apply(this,arguments);return n(),e},history.replaceState=function(){const t=e.apply(this,arguments);return n(),t},window.addEventListener("popstate",n)}(),d(),l(),function(){if(console.log("LibraryScript: Patching fetch"),!window.fetch)return;const t=window.fetch;window.fetch=function(e,n){const o="string"==typeof e?e:e&&e.url,r=t.apply(this,arguments);return o&&-1!==o.indexOf("/customer/session/get")?(console.log("LibraryScript: Fetching session get for URL:",o),r.then(function(t){try{t.clone().json().then(function(t){t&&t.user&&(console.log("LibraryScript: fetch causing tweaks to run"),d(),l())}).catch(function(){})}catch(t){}}).catch(function(){})):console.log("LibraryScript: Ignoring Fetch for URL:",o),r}}()}();