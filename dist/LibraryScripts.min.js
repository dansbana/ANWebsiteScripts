!function(){window.version="dev",console.log("Loading Custom Library Functionaltiy",location.pathname);let t=null,e=null;const n={observer:null,container:null},o={observer:null,container:null};function r(t,e,n){const o=document.querySelector(e);if(o){if(t.observer){if(t.container&&document.contains(t.container))return;t.observer.disconnect(),t.observer=null,t.container=null}t.observer=new MutationObserver(n),t.observer.observe(o,{childList:!0,subtree:!0}),t.container=o}}function c(t,e,n,o){const r=e?e.toLowerCase():null;document.querySelectorAll(t).forEach(t=>{const e=t.textContent.replace(/\s+/g," ").trim().toLowerCase();r&&!e.includes(r)||(t.innerHTML=n,"function"==typeof o&&t.addEventListener("click",o))})}function a(t,e){const n=Array.isArray(e)?e:[e];document.querySelectorAll(t).forEach(t=>{const e=t.textContent.replace(/\s+/g," ").trim().toLowerCase();n.some(t=>e.includes(t.toLowerCase()))&&(t.style.display="none")})}function i(){c("h3","Request","Place Library Order"),c("button.ant-btn-primary","submit quote","Submit order"),c(".ant-modal-body p","This option is for",""),c(".ant-modal-body p","Use the box below","Any special instructions or questions about your order?"),c(".ant-modal-body em","your cart will be","Your cart will be cleared upon submitting your order."),function(t){const e=document.querySelector(".ant-modal-body textarea.ant-input");if(!e)return;const n=Object.getPrototypeOf(e),o=Object.getOwnPropertyDescriptor(n,"value")?.set;o?o.call(e,t):e.value=t;const r=new Event("input",{bubbles:!0});e.dispatchEvent(r)}("My order is good to go.")}function s(){c("button.ant-btn.ant-btn-default.ant-btn-block","Request a school","Place Library Order",()=>setTimeout(i,50)),a("button.ant-btn-default.checkout-btn","Ship"),a("button.ant-btn-primary.checkout-btn","Pick up"),a("button.ant-btn-default.ant-btn-block","Deliver")}function u(){c("span","requested a quote","<strong>Order Type</strong> Library"),c(".ant-card-body div:not(:has(*))","requested a quote","Standard library delivery")}function l(){const c=location.pathname.startsWith("/checkout/cart"),a=location.pathname.startsWith("/account/orders");if(!c&&!a)return void(t&&(clearInterval(t),t=null,e=null));const i=c?"cart":"order";if(t){if(e===i)return;clearInterval(t),t=null,e=null}c?r(n,"aside.responsiveSummary",s):a&&r(o,"aside.responsiveSummaryLeft",u);let l=0,d=!1;const b=c?20:40;e=i,t=setInterval(()=>{l++;try{(function(t){if(console.log("showAccountIdWhenRequested: Showing account ID for user:",t.corp_id),!ShowAcctIds.length||!t)return;const e=ShowAcctIds.map(t=>t.toLowerCase()),n=document.querySelectorAll("button.ant-btn-primary.styled_btn span,.ant-avatar-string div,.ant-drawer-title");n.length&&n.forEach(n=>{const o=n.textContent.trim().toLowerCase();e.some(t=>o.includes(t))&&(n.textContent.includes("ID:")||(n.textContent=`${t.company||t.first_name} (ID: ${t.corp_id} VER: ${window.version})`))})})(libUser),c?s():a&&(u(),Array.from(document.querySelectorAll("span")).some(t=>{const e=t.textContent.toLowerCase();return e.includes("order type")&&e.includes("library")})&&(d=!0))}catch(t){console.error("CustLibFunc: watcher error in interval",t)}!d&&b>l||(clearInterval(t),t=null,e=null)},c?125:250)}function d(){console.log("CustLibFunc: runLibTweaksForCurrentPage on",location.pathname),location.pathname.startsWith("/checkout/cart")&&s(),location.pathname.startsWith("/account/orders")&&(console.log("CustLibFunc: Order Summary Watcher Running"),c(".ant-result-title span","your quote request has been submitted","<strong>Your order has been submitted.</strong><br/><br/>"),c(".ant-result-subtitle div","we will review your quote and comments","<b>IMPORTANT NOTE: Your email confirmation will label this order a &quot;Quote Request,&quot; but we will process it as an order from your library.</b>"))}!function(){const t=history.pushState,e=history.replaceState;function n(){d(),l()}history.pushState=function(){const e=t.apply(this,arguments);return n(),e},history.replaceState=function(){const t=e.apply(this,arguments);return n(),t},window.addEventListener("popstate",n)}(),d(),l(),function(){if(console.log("LibraryScript: Patching fetch"),!window.fetch)return;const t=window.fetch;window.fetch=function(e,n){const o="string"==typeof e?e:e&&e.url,r=t.apply(this,arguments);return o&&-1!==o.indexOf("/customer/session/get")?(console.log("LibraryScript: Fetching session get for URL:",o),r.then(function(t){try{t.clone().json().then(function(t){t&&t.user&&(console.log("LibraryScript: fetch causing tweaks to run"),d(),l())}).catch(function(){})}catch(t){}}).catch(function(){})):console.log("LibraryScript: Ignoring Fetch for URL:",o),r}}()}();