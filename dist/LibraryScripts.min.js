!function(){console.log("Loading Custom Library Functionaltiy",location.pathname);let t=!1,e=null;function n(){console.log("CustLibFunc: runLibTweaksForCurrentPage on",location.pathname),l(),function(){if(e)return;let t=0;e=setInterval(()=>{t++;try{l()}catch(t){console.error("CustLibFunc: libraryTweak error in interval",t)}20>t||(clearInterval(e),e=null)},250)}(),location.pathname.startsWith("/account/order")&&(console.log("CustLibFunc: Order Summary Watcher Running"),function(){let t=0,e=!1;const n=setInterval(()=>{t++,o("span","requested a quote","<strong>Order Type</strong> Library"),o(".ant-card-body div:not(:has(*))","requested a quote","Standard library delivery");const r=Array.from(document.querySelectorAll("span")).some(t=>{const e=t.textContent.toLowerCase();return e.includes("order type")&&e.includes("library")});!e&&40>t||clearInterval(n),r&&(e=!0)},250)}())}function o(t,e,n,o){const r=e?e.toLowerCase():null;document.querySelectorAll(t).forEach(t=>{const e=t.textContent.replace(/\s+/g," ").trim().toLowerCase();r&&!e.includes(r)||(t.innerHTML=n,"function"==typeof o&&t.addEventListener("click",o))})}function r(t,e){const n=Array.isArray(e)?e:[e];document.querySelectorAll(t).forEach(t=>{const e=t.textContent.replace(/\s+/g," ").trim().toLowerCase();n.some(t=>e.includes(t.toLowerCase()))&&(t.style.display="none")})}const c="button.ant-btn.ant-btn-default.ant-btn-block",i="button.ant-btn-default.checkout-btn",a="button.ant-btn-primary.checkout-btn",s="button.ant-btn-default.ant-btn-block";function u(){o("h3","Request","Place Library Order"),o("button.ant-btn-primary","submit quote","Submit order"),o(".ant-modal-body p","This option is for",""),o(".ant-modal-body p","Use the box below","Any special instructions or questions about your order?"),o(".ant-modal-body em","your cart will be","Your cart will be cleared upon submitting your order."),function(t){const e=document.querySelector(".ant-modal-body textarea.ant-input");if(!e)return;const n=Object.getPrototypeOf(e),o=Object.getOwnPropertyDescriptor(n,"value")?.set;o?o.call(e,t):e.value=t;const r=new Event("input",{bubbles:!0});e.dispatchEvent(r)}("My order is good to go.")}function l(){o(c,"Request a school","Place Library Order",()=>setTimeout(u,50)),r(i,"Ship"),r(a,"Pick up"),r(s,"Deliver"),o(".ant-result-title span","your quote request has been submitted","<strong>Your order has been submitted.</strong><br/><br/>"),o(".ant-result-subtitle div","we will review your quote and comments","<b>IMPORTANT NOTE: Your email confirmation will label this order a &quot;Quote Request,&quot; but we will process it as an order from your library.</b>")}!function(){if(!window.fetch)return;const e=window.fetch;window.fetch=function(o,r){const c="string"==typeof o?o:o&&o.url,i=e.apply(this,arguments);return c&&-1!==c.indexOf("/customer/session/get")&&i.then(function(e){try{e.clone().json().then(function(e){const o=e&&e.user;o&&(!function(t){if(!window.ShowAcctIds||!Array.isArray(window.ShowAcctIds))return;const e=window.ShowAcctIds.map(t=>t.toLowerCase()),n=document.querySelectorAll("button.ant-btn-primary.styled_btn span,.ant-avatar-string div,.ant-drawer-title");n.length&&n.forEach(n=>{const o=n.textContent.trim().toLowerCase();e.some(t=>o.includes(t))&&(n.textContent.includes("ID:")||(n.textContent=`${t.company||t.first_name} (ID: ${t.corp_id})`))})}(o),libAccts.includes(o.corp_id)?(console.log("CustLibFunc: Library account detected"),t=!0,n()):console.log("CustLibFunc: Non-library account."))}).catch(function(){})}catch(t){}}).catch(function(){}),i}}(),function(){const e=history.pushState,o=history.replaceState;function r(){t&&n()}function c(){console.log("Poking app to refetch session via focus/visibility...");try{window.dispatchEvent(new Event("focus"))}catch(t){}try{document.dispatchEvent(new Event("visibilitychange"))}catch(t){}}history.pushState=function(){const t=e.apply(this,arguments);return r(),t},history.replaceState=function(){const t=o.apply(this,arguments);return r(),t},window.addEventListener("popstate",r),"complete"===document.readyState||"interactive"===document.readyState?setTimeout(c,50):window.addEventListener("DOMContentLoaded",function(){setTimeout(c,50)})}()}();