!function(){const t="undefined"!=typeof window&&window.logger||function(t,...e){console.log(t+":",...e)},e="undefined"!=typeof window&&window.LOG_LEVEL||Object.freeze({ERROR:"ERROR",WARN:"WARN",TRACE:"TRACE",VERBOSE:"VERBOSE"});window.version="V1.0.109",t(e.TRACE,"Loading Custom Library Functionaltiy",location.pathname);let n=null,o=null;const r={observer:null,container:null},a={observer:null,container:null};function i(t,e,n){const o=document.querySelector(e);if(o){if(t.observer){if(t.container&&document.contains(t.container))return;t.observer.disconnect(),t.observer=null,t.container=null}t.observer=new MutationObserver(n),t.observer.observe(o,{childList:!0,subtree:!0}),t.container=o}}function c(t,e,n,o){const r=e?e.toLowerCase():null;document.querySelectorAll(t).forEach(t=>{const e=t.textContent.replace(/\s+/g," ").trim().toLowerCase();r&&!e.includes(r)||(t.innerHTML=n,"function"==typeof o&&t.addEventListener("click",o))})}function s(t,e){const n=Array.isArray(e)?e:[e];document.querySelectorAll(t).forEach(t=>{const e=t.textContent.replace(/\s+/g," ").trim().toLowerCase();n.some(t=>e.includes(t.toLowerCase()))&&(t.style.display="none")})}function u(){t(e.VERBOSE,"changeSubmitQuoteModal: Changing submit quote modal"),c("h3","Request","Place Library Order"),c("button.ant-btn-primary","submit quote","Submit order"),c(".ant-modal-body p","This option is for",""),c(".ant-modal-body p","Use the box below","Any special instructions or questions about your order?"),c(".ant-modal-body em","your cart will be","Your cart will be cleared upon submitting your order."),function(t){const e=document.querySelector(".ant-modal-body textarea.ant-input");if(!e)return;const n=Object.getPrototypeOf(e),o=Object.getOwnPropertyDescriptor(n,"value")?.set;o?o.call(e,t):e.value=t;const r=new Event("input",{bubbles:!0});e.dispatchEvent(r)}("My order is good to go.")}function l(){t(e.VERBOSE,"changeCartPageFunctionality: Changing cart page functionality"),c("button.ant-btn.ant-btn-default.ant-btn-block","Request a school","Place Library Order",()=>setTimeout(u,50)),s("button.ant-btn-default.checkout-btn","Ship"),s("button.ant-btn-primary.checkout-btn","Pick up"),s("button.ant-btn-default.ant-btn-block","Deliver")}function d(){t(e.VERBOSE,"changeOrderPage: Changing order page functionality"),c("span","requested a quote","<strong>Order Type</strong> Library"),c(".ant-card-body div:not(:has(*))","requested a quote","Standard library delivery")}function b(){const c=location.pathname.startsWith("/checkout/cart"),s=location.pathname.startsWith("/account/order");if(!c&&!s)return t(e.VERBOSE,"LS.startWatchersAndObservers: Not a page we handle - stopping watcher.  Page is ",location.pathname),window.showAccountIdWhenRequested(libUser,window.version),void(n&&(clearTimeout(n),n=null,o=null));const u=c?"cart":"order";if(n){if(o===u)return void t(e.VERBOSE,"LS.startWatchersAndObservers: Same page type, watcher already running, exiting early.  Page is ",location.pathname);t(e.VERBOSE,"LS.startWatchersAndObservers: Page type changed, stopping old watcher.  Page is ",location.pathname),clearTimeout(n),n=null,o=null}c?i(r,"aside.responsiveSummary",l):s&&i(a,"aside.responsiveSummaryLeft",d);let b=0,p=3;o=u,n=setTimeout(function r(){b++,p+=p;try{t(e.VERBOSE,"Watcher loop number ",b," with delary of ",p,"ms"),window.showAccountIdWhenRequested(libUser,window.version),h()}catch(n){t(e.ERROR,"CustLibFunc: watcher error in interval",n)}10>b?n=setTimeout(r,p):(n=null,o=null)},p)}function h(){t(e.TRACE,"LS.runLibTweaksForCurrentPage::running on page:",location.pathname),location.pathname.startsWith("/checkout/cart")&&(t(e.VERBOSE,"LS.runLibTweaksForCurrentPage: Cart page "),l()),location.pathname.startsWith("/account/order")&&(t(e.VERBOSE,"LS.runLibTweaksForCurrentPage: Order page "),t(e.VERBOSE,"changeOrderConfirmationFunctionality: Changing order confirmation functionality"),c(".ant-result-title span","your quote request has been submitted","<strong>Your order has been submitted.</strong><br/><br/>"),c(".ant-result-subtitle div","we will review your quote and comments","<b>IMPORTANT NOTE: Your email confirmation will label this order a &quot;Quote Request,&quot; but we will process it as an order from your library.</b>"),d())}!function(){const t=history.pushState,e=history.replaceState;function n(){h(),b()}history.pushState=function(){const e=t.apply(this,arguments);return n(),e},history.replaceState=function(){const t=e.apply(this,arguments);return n(),t},window.addEventListener("popstate",n)}(),h(),b(),function(){if(t(e.TRACE,"LibraryScript: Patching fetch"),!window.fetch)return;const n=window.fetch;window.fetch=function(o,r){const a="string"==typeof o?o:o&&o.url,i=n.apply(this,arguments);return a&&-1!==a.indexOf("/customer/session/get")?(t(e.VERBOSE,"LibraryScript: Fetching session get for URL:",a),i.then(function(n){try{n.clone().json().then(function(n){n&&n.user&&(t(e.TRACE,"LibraryScript: fetch causing tweaks to run"),h(),b())}).catch(function(){})}catch(t){}}).catch(function(){})):t(e.VERBOSE,"LibraryScript: Ignoring Fetch for URL:",a),i}}()}();