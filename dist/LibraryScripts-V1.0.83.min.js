!function(){const t="undefined"!=typeof window&&window.logger||function(t,...n){console.log(t+":",...n)},n="undefined"!=typeof window&&window.LOG_LEVEL||Object.freeze({ERROR:"ERROR",WARN:"WARN",TRACE:"TRACE",VERBOSE:"VERBOSE"});window.version="V1.0.83",t(n.TRACE,"Loading Custom Library Functionaltiy",location.pathname);let e=null,r=null;const o={observer:null,container:null},a={observer:null,container:null};function i(t,n,e){const r=document.querySelector(n);if(r){if(t.observer){if(t.container&&document.contains(t.container))return;t.observer.disconnect(),t.observer=null,t.container=null}t.observer=new MutationObserver(e),t.observer.observe(r,{childList:!0,subtree:!0}),t.container=r}}function c(t,n,e,r){const o=n?n.toLowerCase():null;document.querySelectorAll(t).forEach(t=>{const n=t.textContent.replace(/\s+/g," ").trim().toLowerCase();o&&!n.includes(o)||(t.innerHTML=e,"function"==typeof r&&t.addEventListener("click",r))})}function u(t,n){const e=Array.isArray(n)?n:[n];document.querySelectorAll(t).forEach(t=>{const n=t.textContent.replace(/\s+/g," ").trim().toLowerCase();e.some(t=>n.includes(t.toLowerCase()))&&(t.style.display="none")})}function s(){t(n.VERBOSE,"changeSubmitQuoteModal: Changing submit quote modal"),c("h3","Request","Place Library Order"),c("button.ant-btn-primary","submit quote","Submit order"),c(".ant-modal-body p","This option is for",""),c(".ant-modal-body p","Use the box below","Any special instructions or questions about your order?"),c(".ant-modal-body em","your cart will be","Your cart will be cleared upon submitting your order."),function(t){const n=document.querySelector(".ant-modal-body textarea.ant-input");if(!n)return;const e=Object.getPrototypeOf(n),r=Object.getOwnPropertyDescriptor(e,"value")?.set;r?r.call(n,t):n.value=t;const o=new Event("input",{bubbles:!0});n.dispatchEvent(o)}("My order is good to go.")}function l(){t(n.VERBOSE,"changeCartPageFunctionality: Changing cart page functionality"),c("button.ant-btn.ant-btn-default.ant-btn-block","Request a school","Place Library Order",()=>setTimeout(s,50)),u("button.ant-btn-default.checkout-btn","Ship"),u("button.ant-btn-primary.checkout-btn","Pick up"),u("button.ant-btn-default.ant-btn-block","Deliver")}function d(){t(n.VERBOSE,"changeOrderPage: Changing order page functionality"),c("span","requested a quote","<strong>Order Type</strong> Library"),c(".ant-card-body div:not(:has(*))","requested a quote","Standard library delivery")}function b(){const c=location.pathname.startsWith("/checkout/cart"),u=location.pathname.startsWith("/account/order");if(!c&&!u)return void(e&&(clearInterval(e),e=null,r=null));const s=c?"cart":"order";if(e){if(r===s)return;clearInterval(e),e=null,r=null}c?i(o,"aside.responsiveSummary",l):u&&i(a,"aside.responsiveSummaryLeft",d);let b=0,h=!1;const y=c?20:40;r=s,e=setInterval(()=>{b++;try{(function(e){if(t(n.VERBOSE,"showAccountIdWhenRequested: Showing account ID for user:",e.corp_id),!ShowAcctIds.length||!e)return;const r=ShowAcctIds.map(t=>t.toLowerCase()),o=document.querySelectorAll("button.ant-btn-primary.styled_btn span,.ant-avatar-string div,.ant-drawer-title");o.length&&o.forEach(t=>{const n=t.textContent.trim().toLowerCase();r.some(t=>n.includes(t))&&(t.textContent.includes("ID:")||(t.textContent=`${e.company||e.first_name} (ID: ${e.corp_id} VER: ${window.version})`))})})(libUser),c?(t(n.VERBOSE,"Watcher calling changeCartPageFunctionality"),l()):u&&(t(n.VERBOSE,"Watcher calling changeOrderPage"),d(),Array.from(document.querySelectorAll("span")).some(t=>{const n=t.textContent.toLowerCase();return n.includes("order type")&&n.includes("library")})&&(h=!0))}catch(e){t(n.ERROR,"CustLibFunc: watcher error in interval",e)}!h&&y>b||(clearInterval(e),e=null,r=null)},c?125:250)}function h(){t(n.TRACE,"CustLibFunc: runLibTweaksForCurrentPage on",location.pathname),location.pathname.startsWith("/checkout/cart")&&l(),location.pathname.startsWith("/account/orders")&&(t(n.TRACE,"CustLibFunc: Order Summary Watcher Running"),t(n.VERBOSE,"changeOrderConfirmationFunctionality: Changing order confirmation functionality"),c(".ant-result-title span","your quote request has been submitted","<strong>Your order has been submitted.</strong><br/><br/>"),c(".ant-result-subtitle div","we will review your quote and comments","<b>IMPORTANT NOTE: Your email confirmation will label this order a &quot;Quote Request,&quot; but we will process it as an order from your library.</b>"))}window.cleanupLibraryScript=function(){t(n.TRACE,"LibraryScripts: Cleaning up watchers and observers"),e&&(clearInterval(e),e=null,r=null),o.observer&&(o.observer.disconnect(),o.observer=null,o.container=null),a.observer&&(a.observer.disconnect(),a.observer=null,a.container=null)},function(){const t=history.pushState,n=history.replaceState;function e(){h(),b()}history.pushState=function(){const n=t.apply(this,arguments);return e(),n},history.replaceState=function(){const t=n.apply(this,arguments);return e(),t},window.addEventListener("popstate",e)}(),h(),b(),function(){if(t(n.TRACE,"LibraryScript: Patching fetch"),!window.fetch)return;const e=window.fetch;window.fetch=function(r,o){const a="string"==typeof r?r:r&&r.url,i=e.apply(this,arguments);return a&&-1!==a.indexOf("/customer/session/get")?(t(n.VERBOSE,"LibraryScript: Fetching session get for URL:",a),i.then(function(e){try{e.clone().json().then(function(e){e&&e.user&&(t(n.TRACE,"LibraryScript: fetch causing tweaks to run"),h(),b())}).catch(function(){})}catch(t){}}).catch(function(){})):t(n.VERBOSE,"LibraryScript: Ignoring Fetch for URL:",a),i}}()}();